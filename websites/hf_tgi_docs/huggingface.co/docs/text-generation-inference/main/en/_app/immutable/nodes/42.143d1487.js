import{s as P,n as L,o as O}from"../chunks/scheduler.362310b7.js";import{S as K,i as ss,g as c,s as l,r as I,A as as,h as o,f as t,c as p,j as R,u as w,x as d,k as H,y as ts,a as n,v as b,d as C,t as _,w as f}from"../chunks/index.57dfc70d.js";import{C as ns}from"../chunks/CodeBlock.5d40996c.js";import{H as Y,E as ls}from"../chunks/index.fa158b42.js";function ps(V){let u,g,m,A,e,E,i,$="Text Generation Inference collects anonymous usage statistics to help us improve the service. The collected data is used to improve TGI and to understand what causes failures. The data is collected transparently and any sensitive information is omitted.",Q,M,W="Usage statistics are collected only when TGI is running in a Docker container. This prevents data collection when TGI is run directly on the host machine. The collected data includes startup and shutdown events, as well as a heartbeat signal sent every 15 minutes.",B,j,X,h,D=`The code that collects the data is available <a href="https://github.com/huggingface/text-generation-inference/blob/main/router/src/usage_stats.rs" rel="nofollow">here</a>.
As of release 2.1.2 this is an example of the data collected:`,S,y,F="<li>From the TGI configuration:</li>",N,r,Z,J,x,U,G=`By passing the <code>--usage-stats</code> to the text-generation-launcher you can control how much usage statistics are being collected.
<code>--usage-stats=no-stack</code> will not emit the stack traces from errors and the error types, but will continue to send start and stop events
<code>--usage-stats=off</code> will completely disable everything`,k,T,v,q,z;return e=new Y({props:{title:"Collection of Usage Statistics",local:"collection-of-usage-statistics",headingTag:"h1"}}),j=new Y({props:{title:"What data is collected",local:"what-data-is-collected",headingTag:"h2"}}),r=new ns({props:{code:"JTdCJTBBJTIwJTIwJTIyZXZlbnRfdHlwZSUyMiUzQSUyMCUyMnN0YXJ0JTIyJTJDJTBBJTIwJTIwJTIyZGlzYWJsZV9ncmFtbWFyX3N1cHBvcnQlMjIlM0ElMjBmYWxzZSUyQyUwQSUyMCUyMCUyMm1heF9iYXRjaF9wcmVmaWxsX3Rva2VucyUyMiUzQSUyMDQwOTYlMkMlMEElMjAlMjAlMjJtYXhfYmF0Y2hfc2l6ZSUyMiUzQSUyMG51bGwlMkMlMEElMjAlMjAlMjJtYXhfYmF0Y2hfdG90YWxfdG9rZW5zJTIyJTNBJTIwbnVsbCUyQyUwQSUyMCUyMCUyMm1heF9iZXN0X29mJTIyJTNBJTIwMiUyQyUwQSUyMCUyMCUyMm1heF9jbGllbnRfYmF0Y2hfc2l6ZSUyMiUzQSUyMDQlMkMlMEElMjAlMjAlMjJtYXhfY29uY3VycmVudF9yZXF1ZXN0cyUyMiUzQSUyMDEyOCUyQyUwQSUyMCUyMCUyMm1heF9pbnB1dF90b2tlbnMlMjIlM0ElMjAxMDI0JTJDJTBBJTIwJTIwJTIybWF4X3N0b3Bfc2VxdWVuY2VzJTIyJTNBJTIwNCUyQyUwQSUyMCUyMCUyMm1heF90b3Bfbl90b2tlbnMlMjIlM0ElMjA1JTJDJTBBJTIwJTIwJTIybWF4X3RvdGFsX3Rva2VucyUyMiUzQSUyMDIwNDglMkMlMEElMjAlMjAlMjJtYXhfd2FpdGluZ190b2tlbnMlMjIlM0ElMjAyMCUyQyUwQSUyMCUyMCUyMm1vZGVsX2NvbmZpZyUyMiUzQSUyMCU3QiUwQSUyMCUyMCUyMCUyMCUyMm1vZGVsX3R5cGUlMjIlM0ElMjAlMjJCbG9vbSUyMiUwQSUyMCUyMCU3RCUyQyUwQSUyMCUyMCUyMnJldmlzaW9uJTIyJTNBJTIwbnVsbCUyQyUwQSUyMCUyMCUyMnRva2VuaXplcl9jbGFzcyUyMiUzQSUyMCUyMkJsb29tVG9rZW5pemVyRmFzdCUyMiUyQyUwQSUyMCUyMCUyMnZhbGlkYXRpb25fd29ya2VycyUyMiUzQSUyMDIlMkMlMEElMjAlMjAlMjJ3YWl0aW5nX3NlcnZlZF9yYXRpbyUyMiUzQSUyMDEuMiUyQyUwQSUyMCUyMCUyMmRvY2tlcl9sYWJlbCUyMiUzQSUyMCUyMmxhdGVzdCUyMiUyQyUwQSUyMCUyMCUyMmdpdF9zaGElMjIlM0ElMjAlMjJjZmMxMTg3MDQ4ODA0NTNkMjliY2JlNGZiYmQ5MWRkYTUwMWNmNWZlJTIyJTJDJTBBJTIwJTIwJTIybnZpZGlhX2VudiUyMiUzQSUyMCU3QiUwQSUyMCUyMCUyMCUyMCUyMm5hbWUlMjIlM0ElMjAlMjJOVklESUElMjBBMTBHJTIyJTJDJTBBJTIwJTIwJTIwJTIwJTIycGNpX2J1c19pZCUyMiUzQSUyMCUyMjAwMDAwMDAwJTNBMDAlM0ExRS4wJTIyJTJDJTBBJTIwJTIwJTIwJTIwJTIyZHJpdmVyX3ZlcnNpb24lMjIlM0ElMjAlMjI1MzUuMTgzLjAxJTIyJTJDJTBBJTIwJTIwJTIwJTIwJTIycHN0YXRlJTIyJTNBJTIwJTIyUDglMjIlMkMlMEElMjAlMjAlMjAlMjAlMjJwY2llX2xpbmtfZ2VuX21heCUyMiUzQSUyMCUyMjQlMjIlMkMlMEElMjAlMjAlMjAlMjAlMjJwY2llX2xpbmtfZ2VuX2N1cnJlbnQlMjIlM0ElMjAlMjIxJTIyJTJDJTBBJTIwJTIwJTIwJTIwJTIydGVtcGVyYXR1cmVfZ3B1JTIyJTNBJTIwJTIyMzElMjIlMkMlMEElMjAlMjAlMjAlMjAlMjJ1dGlsaXphdGlvbl9ncHUlMjIlM0ElMjAlMjIwJTIwJTI1JTIyJTJDJTBBJTIwJTIwJTIwJTIwJTIydXRpbGl6YXRpb25fbWVtb3J5JTIyJTNBJTIwJTIyMCUyMCUyNSUyMiUyQyUwQSUyMCUyMCUyMCUyMCUyMm1lbW9yeV90b3RhbCUyMiUzQSUyMCUyMjIzMDI4JTIwTWlCJTIyJTJDJTBBJTIwJTIwJTIwJTIwJTIybWVtb3J5X2ZyZWUlMjIlM0ElMjAlMjIyMjUxNSUyME1pQiUyMiUyQyUwQSUyMCUyMCUyMCUyMCUyMm1lbW9yeV91c2VkJTIyJTNBJTIwJTIyMCUyME1pQiUyMiUyQyUwQSUyMCUyMCUyMCUyMCUyMnJlc2V0X3N0YXR1c19yZXNldF9yZXF1aXJlZCUyMiUzQSUyMCUyMk5vJTIyJTJDJTBBJTIwJTIwJTIwJTIwJTIycmVzZXRfc3RhdHVzX2RyYWluX2FuZF9yZXNldF9yZWNvbW1lbmRlZCUyMiUzQSUyMCUyMk5vJTIyJTJDJTBBJTIwJTIwJTIwJTIwJTIyY29tcHV0ZV9jYXAlMjIlM0ElMjAlMjI4LjYlMjIlMkMlMEElMjAlMjAlMjAlMjAlMjJlY2NfZXJyb3JzX2NvcnJlY3RlZF92b2xhdGlsZV90b3RhbCUyMiUzQSUyMCUyMjAlMjIlMkMlMEElMjAlMjAlMjAlMjAlMjJtaWdfbW9kZV9jdXJyZW50JTIyJTNBJTIwJTIyJTVCTiUyRkElNUQlMjIlMkMlMEElMjAlMjAlMjAlMjAlMjJwb3dlcl9kcmF3X2luc3RhbnQlMjIlM0ElMjAlMjIxMC44NiUyMFclMjIlMkMlMEElMjAlMjAlMjAlMjAlMjJwb3dlcl9saW1pdCUyMiUzQSUyMCUyMjMwMC4wMCUyMFclMjIlMEElMjAlMjAlN0QlMkMlMEElMjAlMjAlMjJzeXN0ZW1fZW52JTIyJTNBJTIwJTdCJTBBJTIwJTIwJTIwJTIwJTIyY3B1X2NvdW50JTIyJTNBJTIwMTYlMkMlMEElMjAlMjAlMjAlMjAlMjJjcHVfdHlwZSUyMiUzQSUyMCUyMkFNRCUyMEVQWUMlMjA3UjMyJTIyJTJDJTBBJTIwJTIwJTIwJTIwJTIydG90YWxfbWVtb3J5JTIyJTNBJTIwNjY2ODExOTY1NDQlMkMlMEElMjAlMjAlMjAlMjAlMjJhcmNoaXRlY3R1cmUlMjIlM0ElMjAlMjJ4ODZfNjQlMjIlMkMlMEElMjAlMjAlMjAlMjAlMjJwbGF0Zm9ybSUyMiUzQSUyMCUyMmxpbnV4LXVuaXgteDg2XzY0JTIyJTBBJTIwJTIwJTdEJTBBJTdEJTBB",highlighted:`<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;event_type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;disable_grammar_support&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_batch_prefill_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4096</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_batch_size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_batch_total_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_best_of&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_client_batch_size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_concurrent_requests&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">128</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_input_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_stop_sequences&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_top_n_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_total_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;max_waiting_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;model_config&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;model_type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Bloom&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;revision&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;tokenizer_class&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;BloomTokenizerFast&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;validation_workers&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;waiting_served_ratio&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1.2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;docker_label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;latest&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;git_sha&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cfc118704880453d29bcbe4fbbd91dda501cf5fe&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;nvidia_env&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;NVIDIA A10G&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;pci_bus_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;00000000:00:1E.0&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;driver_version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;535.183.01&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;pstate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;P8&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;pcie_link_gen_max&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;pcie_link_gen_current&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;temperature_gpu&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;31&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;utilization_gpu&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0 %&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;utilization_memory&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0 %&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;memory_total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;23028 MiB&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;memory_free&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;22515 MiB&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;memory_used&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0 MiB&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;reset_status_reset_required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;No&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;reset_status_drain_and_reset_recommended&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;No&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;compute_cap&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;8.6&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;ecc_errors_corrected_volatile_total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;mig_mode_current&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;[N/A]&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;power_draw_instant&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;10.86 W&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;power_limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;300.00 W&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;system_env&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;cpu_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">16</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;cpu_type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;AMD EPYC 7R32&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_memory&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">66681196544</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;architecture&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;x86_64&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;platform&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;linux-unix-x86_64&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
`,wrap:!1}}),J=new Y({props:{title:"How to opt-out",local:"how-to-opt-out",headingTag:"h2"}}),T=new ls({props:{source:"https://github.com/huggingface/text-generation-inference/blob/main/docs/source/usage_statistics.md"}}),{c(){u=c("meta"),g=l(),m=c("p"),A=l(),I(e.$$.fragment),E=l(),i=c("p"),i.textContent=$,Q=l(),M=c("p"),M.textContent=W,B=l(),I(j.$$.fragment),X=l(),h=c("p"),h.innerHTML=D,S=l(),y=c("ul"),y.innerHTML=F,N=l(),I(r.$$.fragment),Z=l(),I(J.$$.fragment),x=l(),U=c("p"),U.innerHTML=G,k=l(),I(T.$$.fragment),v=l(),q=c("p"),this.h()},l(s){const a=as("svelte-u9bgzb",document.head);u=o(a,"META",{name:!0,content:!0}),a.forEach(t),g=p(s),m=o(s,"P",{}),R(m).forEach(t),A=p(s),w(e.$$.fragment,s),E=p(s),i=o(s,"P",{"data-svelte-h":!0}),d(i)!=="svelte-2eqz6t"&&(i.textContent=$),Q=p(s),M=o(s,"P",{"data-svelte-h":!0}),d(M)!=="svelte-kyv7n7"&&(M.textContent=W),B=p(s),w(j.$$.fragment,s),X=p(s),h=o(s,"P",{"data-svelte-h":!0}),d(h)!=="svelte-1ss2ebj"&&(h.innerHTML=D),S=p(s),y=o(s,"UL",{"data-svelte-h":!0}),d(y)!=="svelte-1lhp668"&&(y.innerHTML=F),N=p(s),w(r.$$.fragment,s),Z=p(s),w(J.$$.fragment,s),x=p(s),U=o(s,"P",{"data-svelte-h":!0}),d(U)!=="svelte-1d05e6t"&&(U.innerHTML=G),k=p(s),w(T.$$.fragment,s),v=p(s),q=o(s,"P",{}),R(q).forEach(t),this.h()},h(){H(u,"name","hf:doc:metadata"),H(u,"content",us)},m(s,a){ts(document.head,u),n(s,g,a),n(s,m,a),n(s,A,a),b(e,s,a),n(s,E,a),n(s,i,a),n(s,Q,a),n(s,M,a),n(s,B,a),b(j,s,a),n(s,X,a),n(s,h,a),n(s,S,a),n(s,y,a),n(s,N,a),b(r,s,a),n(s,Z,a),b(J,s,a),n(s,x,a),n(s,U,a),n(s,k,a),b(T,s,a),n(s,v,a),n(s,q,a),z=!0},p:L,i(s){z||(C(e.$$.fragment,s),C(j.$$.fragment,s),C(r.$$.fragment,s),C(J.$$.fragment,s),C(T.$$.fragment,s),z=!0)},o(s){_(e.$$.fragment,s),_(j.$$.fragment,s),_(r.$$.fragment,s),_(J.$$.fragment,s),_(T.$$.fragment,s),z=!1},d(s){s&&(t(g),t(m),t(A),t(E),t(i),t(Q),t(M),t(B),t(X),t(h),t(S),t(y),t(N),t(Z),t(x),t(U),t(k),t(v),t(q)),t(u),f(e,s),f(j,s),f(r,s),f(J,s),f(T,s)}}}const us='{"title":"Collection of Usage Statistics","local":"collection-of-usage-statistics","sections":[{"title":"What data is collected","local":"what-data-is-collected","sections":[],"depth":2},{"title":"How to opt-out","local":"how-to-opt-out","sections":[],"depth":2}],"depth":1}';function cs(V){return O(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class js extends K{constructor(u){super(),ss(this,u,cs,ps,P,{})}}export{js as component};
