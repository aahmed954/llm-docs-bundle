import{s as yt,o as vt,n as Tt}from"../chunks/scheduler.bdbef820.js";import{S as Ct,i as Mt,g as i,s as l,r as p,A as Ht,h as o,f as a,c as n,j as qe,u as r,x as c,k as Oe,y as xt,a as s,v as h,d as f,t as m,w as u}from"../chunks/index.c0aea24a.js";import{T as kt}from"../chunks/Tip.31005f7d.js";import{C as $}from"../chunks/CodeBlock.e814ab8d.js";import{H as ie,E as Jt}from"../chunks/index.89e522f3.js";function Zt(ce){let d,w='If you want to reuse a dataset from scratch, try setting the <code>download_mode</code> parameter in <a href="/docs/datasets/v3.6.0/en/package_reference/loading_methods#datasets.load_dataset">load_dataset()</a> instead.';return{c(){d=i("p"),d.innerHTML=w},l(g){d=o(g,"P",{"data-svelte-h":!0}),c(d)!=="svelte-35byea"&&(d.innerHTML=w)},m(g,le){s(g,d,le)},p:Tt,d(g){g&&a(d)}}}function Rt(ce){let d,w,g,le,b,de,y,Qe=`When you download a dataset from Hugging Face, the data are stored locally on your computer.
Files from Hugging Face are stored as usual in the <code>huggingface_hub</code> cache, which is at <code>~/.cache/huggingface/hub</code> by default.
See the <a href="https://huggingface.co/docs/huggingface_hub/guides/manage-cache" rel="nofollow">Hub cache documentation</a> for more details and how to change its location.`,pe,v,Ke="The Hub cache allows ü§ó Datasets to avoid re-downloading dataset files from Hugging Face every time you use them.",re,T,et='ü§ó Datasets also has its own cache to store datasets converted in Arrow format (the format used by <a href="/docs/datasets/v3.6.0/en/package_reference/main_classes#datasets.Dataset">Dataset</a> objects).',he,C,tt="This guide focuses on the ü§ó Datasets cache and will show you how to:",fe,M,at="<li>Change the cache directory.</li> <li>Control how a dataset is loaded from the cache.</li> <li>Clean up cache files in the directory.</li> <li>Enable or disable caching.</li>",me,H,ue,x,st="The default ü§ó Datasets cache directory is <code>~/.cache/huggingface/datasets</code>. Change the cache location by setting the shell environment variable, <code>HF_HOME</code> to another directory:",ge,k,$e,J,lt="Alternatively, you can set the <code>HF_DATASETS_CACHE</code> environment variable to control only the datasets-specific cache directory:",_e,Z,we,R,nt=`‚ö†Ô∏è This only applies to files written by the <code>datasets</code> library (e.g., Arrow files and indices).<br/>
It does <strong>not</strong> affect files downloaded from the Hugging Face Hub (such as models, tokenizers, or raw dataset sources), which are located in <code>~/.cache/huggingface/hub</code> by default and controlled separately via the <code>HF_HUB_CACHE</code> variable:`,be,j,ye,F,it="üí° If you‚Äôd like to relocate all Hugging Face caches ‚Äî including datasets and hub downloads ‚Äî use the <code>HF_HOME</code> variable instead:",ve,L,Te,U,ot="This results in:",Ce,E,ct="<li>datasets cache ‚Üí <code>/path/to/cache_root/datasets</code></li> <li>hub cache ‚Üí <code>/path/to/cache_root/hub</code></li>",Me,I,dt=`These distinctions are especially useful when working in shared environments or networked file systems (e.g., NFS).<br/>
See <a href="https://github.com/huggingface/datasets/issues/7480" rel="nofollow">issue #7480</a> for discussion on how users encountered unexpected cache locations when <code>HF_HUB_CACHE</code> was not set alongside <code>HF_DATASETS_CACHE</code>.`,He,X,pt="When you load a dataset, you also have the option to change where the data is cached. Change the <code>cache_dir</code> parameter to the path you want:",xe,Y,ke,G,Je,S,rt='After you download a dataset, control how it is loaded by <a href="/docs/datasets/v3.6.0/en/package_reference/loading_methods#datasets.load_dataset">load_dataset()</a> with the <code>download_mode</code> parameter. By default, ü§ó Datasets will reuse a dataset if it exists. But if you need the original dataset without any processing functions applied, re-download the files as shown below:',Ze,A,Re,N,ht='Refer to <a href="/docs/datasets/v3.6.0/en/package_reference/builder_classes#datasets.DownloadMode">DownloadMode</a> for a full list of download modes.',je,D,Fe,P,ft='Clean up the Arrow cache files in the directory with <a href="/docs/datasets/v3.6.0/en/package_reference/main_classes#datasets.Dataset.cleanup_cache_files">Dataset.cleanup_cache_files()</a>:',Le,W,Ue,z,Ee,V,mt='If you‚Äôre using a cached file locally, it will automatically reload the dataset with any previous transforms you applied to the dataset. Disable this behavior by setting the argument <code>load_from_cache_file=False</code> in <a href="/docs/datasets/v3.6.0/en/package_reference/main_classes#datasets.Dataset.map">Dataset.map()</a>:',Ie,B,Xe,q,ut="In the example above, ü§ó Datasets will execute the function <code>add_prefix</code> over the entire dataset again instead of loading the dataset from its previous state.",Ye,O,gt='Disable caching on a global scale with <a href="/docs/datasets/v3.6.0/en/package_reference/main_classes#datasets.disable_caching">disable_caching()</a>:',Ge,Q,Se,K,$t="When you disable caching, ü§ó Datasets will no longer reload cached files when applying transforms to datasets. Any transform you apply on your dataset will be need to be reapplied.",Ae,_,Ne,ne,De,ee,Pe,te,_t="Disabling the cache and copying the dataset in-memory will speed up dataset operations. There are two options for copying the dataset in-memory:",We,ae,wt="<li><p>Set <code>datasets.config.IN_MEMORY_MAX_SIZE</code> to a nonzero value (in bytes) that fits in your RAM memory.</p></li> <li><p>Set the environment variable <code>HF_DATASETS_IN_MEMORY_MAX_SIZE</code> to a nonzero value. Note that the first method takes higher precedence.</p></li>",ze,se,Ve,oe,Be;return b=new ie({props:{title:"Cache management",local:"cache-management",headingTag:"h1"}}),H=new ie({props:{title:"Cache directory",local:"cache-directory",headingTag:"h2"}}),k=new $({props:{code:"JTI0JTIwZXhwb3J0JTIwSEZfSE9NRSUzRCUyMiUyRnBhdGglMkZ0byUyRmFub3RoZXIlMkZkaXJlY3RvcnklMkZkYXRhc2V0cyUyMg==",highlighted:'$ <span class="hljs-built_in">export</span> <span class="hljs-attribute">HF_HOME</span>=<span class="hljs-string">&quot;/path/to/another/directory/datasets&quot;</span>',wrap:!1}}),Z=new $({props:{code:"JTI0JTIwZXhwb3J0JTIwSEZfREFUQVNFVFNfQ0FDSEUlM0QlMjIlMkZwYXRoJTJGdG8lMkZkYXRhc2V0c19jYWNoZSUyMg==",highlighted:'$ <span class="hljs-built_in">export</span> <span class="hljs-attribute">HF_DATASETS_CACHE</span>=<span class="hljs-string">&quot;/path/to/datasets_cache&quot;</span>',wrap:!1}}),j=new $({props:{code:"JTI0JTIwZXhwb3J0JTIwSEZfSFVCX0NBQ0hFJTNEJTIyJTJGcGF0aCUyRnRvJTJGaHViX2NhY2hlJTIy",highlighted:'$ <span class="hljs-built_in">export</span> <span class="hljs-attribute">HF_HUB_CACHE</span>=<span class="hljs-string">&quot;/path/to/hub_cache&quot;</span>',wrap:!1}}),L=new $({props:{code:"JTI0JTIwZXhwb3J0JTIwSEZfSE9NRSUzRCUyMiUyRnBhdGglMkZ0byUyRmNhY2hlX3Jvb3QlMjI=",highlighted:'$ <span class="hljs-built_in">export</span> <span class="hljs-attribute">HF_HOME</span>=<span class="hljs-string">&quot;/path/to/cache_root&quot;</span>',wrap:!1}}),Y=new $({props:{code:"ZnJvbSUyMGRhdGFzZXRzJTIwaW1wb3J0JTIwbG9hZF9kYXRhc2V0JTBBZGF0YXNldCUyMCUzRCUyMGxvYWRfZGF0YXNldCgndXNlcm5hbWUlMkZkYXRhc2V0JyUyQyUyMGNhY2hlX2RpciUzRCUyMiUyRnBhdGglMkZ0byUyRmFub3RoZXIlMkZkaXJlY3RvcnklMkZkYXRhc2V0cyUyMik=",highlighted:`<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-meta">&gt;&gt;&gt; </span>dataset = load_dataset(<span class="hljs-string">&#x27;username/dataset&#x27;</span>, cache_dir=<span class="hljs-string">&quot;/path/to/another/directory/datasets&quot;</span>)`,wrap:!1}}),G=new ie({props:{title:"Download mode",local:"download-mode",headingTag:"h2"}}),A=new $({props:{code:"ZnJvbSUyMGRhdGFzZXRzJTIwaW1wb3J0JTIwbG9hZF9kYXRhc2V0JTBBZGF0YXNldCUyMCUzRCUyMGxvYWRfZGF0YXNldCgncmFqcHVya2FyJTJGc3F1YWQnJTJDJTIwZG93bmxvYWRfbW9kZSUzRCdmb3JjZV9yZWRvd25sb2FkJyk=",highlighted:`<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-meta">&gt;&gt;&gt; </span>dataset = load_dataset(<span class="hljs-string">&#x27;rajpurkar/squad&#x27;</span>, download_mode=<span class="hljs-string">&#x27;force_redownload&#x27;</span>)`,wrap:!1}}),D=new ie({props:{title:"Cache files",local:"cache-files",headingTag:"h2"}}),W=new $({props:{code:"ZGF0YXNldC5jbGVhbnVwX2NhY2hlX2ZpbGVzKCk=",highlighted:`<span class="hljs-comment"># Returns the number of removed cache files</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>dataset.cleanup_cache_files()
<span class="hljs-number">2</span>`,wrap:!1}}),z=new ie({props:{title:"Enable or disable caching",local:"enable-or-disable-caching",headingTag:"h2"}}),B=new $({props:{code:"dXBkYXRlZF9kYXRhc2V0JTIwJTNEJTIwc21hbGxfZGF0YXNldC5tYXAoYWRkX3ByZWZpeCUyQyUyMGxvYWRfZnJvbV9jYWNoZV9maWxlJTNERmFsc2Up",highlighted:'<span class="hljs-meta">&gt;&gt;&gt; </span>updated_dataset = small_dataset.<span class="hljs-built_in">map</span>(add_prefix, load_from_cache_file=<span class="hljs-literal">False</span>)',wrap:!1}}),Q=new $({props:{code:"ZnJvbSUyMGRhdGFzZXRzJTIwaW1wb3J0JTIwZGlzYWJsZV9jYWNoaW5nJTBBZGlzYWJsZV9jYWNoaW5nKCk=",highlighted:`<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> disable_caching
<span class="hljs-meta">&gt;&gt;&gt; </span>disable_caching()`,wrap:!1}}),_=new kt({props:{$$slots:{default:[Zt]},$$scope:{ctx:ce}}}),ee=new ie({props:{title:"Improve performance",local:"improve-performance",headingTag:"h2"}}),se=new Jt({props:{source:"https://github.com/huggingface/datasets/blob/main/docs/source/cache.mdx"}}),{c(){d=i("meta"),w=l(),g=i("p"),le=l(),p(b.$$.fragment),de=l(),y=i("p"),y.innerHTML=Qe,pe=l(),v=i("p"),v.textContent=Ke,re=l(),T=i("p"),T.innerHTML=et,he=l(),C=i("p"),C.textContent=tt,fe=l(),M=i("ul"),M.innerHTML=at,me=l(),p(H.$$.fragment),ue=l(),x=i("p"),x.innerHTML=st,ge=l(),p(k.$$.fragment),$e=l(),J=i("p"),J.innerHTML=lt,_e=l(),p(Z.$$.fragment),we=l(),R=i("p"),R.innerHTML=nt,be=l(),p(j.$$.fragment),ye=l(),F=i("p"),F.innerHTML=it,ve=l(),p(L.$$.fragment),Te=l(),U=i("p"),U.textContent=ot,Ce=l(),E=i("ul"),E.innerHTML=ct,Me=l(),I=i("p"),I.innerHTML=dt,He=l(),X=i("p"),X.innerHTML=pt,xe=l(),p(Y.$$.fragment),ke=l(),p(G.$$.fragment),Je=l(),S=i("p"),S.innerHTML=rt,Ze=l(),p(A.$$.fragment),Re=l(),N=i("p"),N.innerHTML=ht,je=l(),p(D.$$.fragment),Fe=l(),P=i("p"),P.innerHTML=ft,Le=l(),p(W.$$.fragment),Ue=l(),p(z.$$.fragment),Ee=l(),V=i("p"),V.innerHTML=mt,Ie=l(),p(B.$$.fragment),Xe=l(),q=i("p"),q.innerHTML=ut,Ye=l(),O=i("p"),O.innerHTML=gt,Ge=l(),p(Q.$$.fragment),Se=l(),K=i("p"),K.textContent=$t,Ae=l(),p(_.$$.fragment),Ne=l(),ne=i("a"),De=l(),p(ee.$$.fragment),Pe=l(),te=i("p"),te.textContent=_t,We=l(),ae=i("ol"),ae.innerHTML=wt,ze=l(),p(se.$$.fragment),Ve=l(),oe=i("p"),this.h()},l(e){const t=Ht("svelte-u9bgzb",document.head);d=o(t,"META",{name:!0,content:!0}),t.forEach(a),w=n(e),g=o(e,"P",{}),qe(g).forEach(a),le=n(e),r(b.$$.fragment,e),de=n(e),y=o(e,"P",{"data-svelte-h":!0}),c(y)!=="svelte-iay7o3"&&(y.innerHTML=Qe),pe=n(e),v=o(e,"P",{"data-svelte-h":!0}),c(v)!=="svelte-19z69yp"&&(v.textContent=Ke),re=n(e),T=o(e,"P",{"data-svelte-h":!0}),c(T)!=="svelte-ohw1kn"&&(T.innerHTML=et),he=n(e),C=o(e,"P",{"data-svelte-h":!0}),c(C)!=="svelte-9v8z4"&&(C.textContent=tt),fe=n(e),M=o(e,"UL",{"data-svelte-h":!0}),c(M)!=="svelte-1pju6bx"&&(M.innerHTML=at),me=n(e),r(H.$$.fragment,e),ue=n(e),x=o(e,"P",{"data-svelte-h":!0}),c(x)!=="svelte-106khif"&&(x.innerHTML=st),ge=n(e),r(k.$$.fragment,e),$e=n(e),J=o(e,"P",{"data-svelte-h":!0}),c(J)!=="svelte-h24suv"&&(J.innerHTML=lt),_e=n(e),r(Z.$$.fragment,e),we=n(e),R=o(e,"P",{"data-svelte-h":!0}),c(R)!=="svelte-16exhn5"&&(R.innerHTML=nt),be=n(e),r(j.$$.fragment,e),ye=n(e),F=o(e,"P",{"data-svelte-h":!0}),c(F)!=="svelte-968r6o"&&(F.innerHTML=it),ve=n(e),r(L.$$.fragment,e),Te=n(e),U=o(e,"P",{"data-svelte-h":!0}),c(U)!=="svelte-3mxhsb"&&(U.textContent=ot),Ce=n(e),E=o(e,"UL",{"data-svelte-h":!0}),c(E)!=="svelte-4qd4zy"&&(E.innerHTML=ct),Me=n(e),I=o(e,"P",{"data-svelte-h":!0}),c(I)!=="svelte-ydfbpl"&&(I.innerHTML=dt),He=n(e),X=o(e,"P",{"data-svelte-h":!0}),c(X)!=="svelte-rd1xw8"&&(X.innerHTML=pt),xe=n(e),r(Y.$$.fragment,e),ke=n(e),r(G.$$.fragment,e),Je=n(e),S=o(e,"P",{"data-svelte-h":!0}),c(S)!=="svelte-ispbjj"&&(S.innerHTML=rt),Ze=n(e),r(A.$$.fragment,e),Re=n(e),N=o(e,"P",{"data-svelte-h":!0}),c(N)!=="svelte-l4pxo2"&&(N.innerHTML=ht),je=n(e),r(D.$$.fragment,e),Fe=n(e),P=o(e,"P",{"data-svelte-h":!0}),c(P)!=="svelte-1ugi2nu"&&(P.innerHTML=ft),Le=n(e),r(W.$$.fragment,e),Ue=n(e),r(z.$$.fragment,e),Ee=n(e),V=o(e,"P",{"data-svelte-h":!0}),c(V)!=="svelte-1033o7h"&&(V.innerHTML=mt),Ie=n(e),r(B.$$.fragment,e),Xe=n(e),q=o(e,"P",{"data-svelte-h":!0}),c(q)!=="svelte-135z99u"&&(q.innerHTML=ut),Ye=n(e),O=o(e,"P",{"data-svelte-h":!0}),c(O)!=="svelte-1rh7my4"&&(O.innerHTML=gt),Ge=n(e),r(Q.$$.fragment,e),Se=n(e),K=o(e,"P",{"data-svelte-h":!0}),c(K)!=="svelte-1cf02ij"&&(K.textContent=$t),Ae=n(e),r(_.$$.fragment,e),Ne=n(e),ne=o(e,"A",{id:!0}),qe(ne).forEach(a),De=n(e),r(ee.$$.fragment,e),Pe=n(e),te=o(e,"P",{"data-svelte-h":!0}),c(te)!=="svelte-1dk1qbe"&&(te.textContent=_t),We=n(e),ae=o(e,"OL",{"data-svelte-h":!0}),c(ae)!=="svelte-1bgoi8z"&&(ae.innerHTML=wt),ze=n(e),r(se.$$.fragment,e),Ve=n(e),oe=o(e,"P",{}),qe(oe).forEach(a),this.h()},h(){Oe(d,"name","hf:doc:metadata"),Oe(d,"content",jt),Oe(ne,"id","load_dataset_enhancing_performance")},m(e,t){xt(document.head,d),s(e,w,t),s(e,g,t),s(e,le,t),h(b,e,t),s(e,de,t),s(e,y,t),s(e,pe,t),s(e,v,t),s(e,re,t),s(e,T,t),s(e,he,t),s(e,C,t),s(e,fe,t),s(e,M,t),s(e,me,t),h(H,e,t),s(e,ue,t),s(e,x,t),s(e,ge,t),h(k,e,t),s(e,$e,t),s(e,J,t),s(e,_e,t),h(Z,e,t),s(e,we,t),s(e,R,t),s(e,be,t),h(j,e,t),s(e,ye,t),s(e,F,t),s(e,ve,t),h(L,e,t),s(e,Te,t),s(e,U,t),s(e,Ce,t),s(e,E,t),s(e,Me,t),s(e,I,t),s(e,He,t),s(e,X,t),s(e,xe,t),h(Y,e,t),s(e,ke,t),h(G,e,t),s(e,Je,t),s(e,S,t),s(e,Ze,t),h(A,e,t),s(e,Re,t),s(e,N,t),s(e,je,t),h(D,e,t),s(e,Fe,t),s(e,P,t),s(e,Le,t),h(W,e,t),s(e,Ue,t),h(z,e,t),s(e,Ee,t),s(e,V,t),s(e,Ie,t),h(B,e,t),s(e,Xe,t),s(e,q,t),s(e,Ye,t),s(e,O,t),s(e,Ge,t),h(Q,e,t),s(e,Se,t),s(e,K,t),s(e,Ae,t),h(_,e,t),s(e,Ne,t),s(e,ne,t),s(e,De,t),h(ee,e,t),s(e,Pe,t),s(e,te,t),s(e,We,t),s(e,ae,t),s(e,ze,t),h(se,e,t),s(e,Ve,t),s(e,oe,t),Be=!0},p(e,[t]){const bt={};t&2&&(bt.$$scope={dirty:t,ctx:e}),_.$set(bt)},i(e){Be||(f(b.$$.fragment,e),f(H.$$.fragment,e),f(k.$$.fragment,e),f(Z.$$.fragment,e),f(j.$$.fragment,e),f(L.$$.fragment,e),f(Y.$$.fragment,e),f(G.$$.fragment,e),f(A.$$.fragment,e),f(D.$$.fragment,e),f(W.$$.fragment,e),f(z.$$.fragment,e),f(B.$$.fragment,e),f(Q.$$.fragment,e),f(_.$$.fragment,e),f(ee.$$.fragment,e),f(se.$$.fragment,e),Be=!0)},o(e){m(b.$$.fragment,e),m(H.$$.fragment,e),m(k.$$.fragment,e),m(Z.$$.fragment,e),m(j.$$.fragment,e),m(L.$$.fragment,e),m(Y.$$.fragment,e),m(G.$$.fragment,e),m(A.$$.fragment,e),m(D.$$.fragment,e),m(W.$$.fragment,e),m(z.$$.fragment,e),m(B.$$.fragment,e),m(Q.$$.fragment,e),m(_.$$.fragment,e),m(ee.$$.fragment,e),m(se.$$.fragment,e),Be=!1},d(e){e&&(a(w),a(g),a(le),a(de),a(y),a(pe),a(v),a(re),a(T),a(he),a(C),a(fe),a(M),a(me),a(ue),a(x),a(ge),a($e),a(J),a(_e),a(we),a(R),a(be),a(ye),a(F),a(ve),a(Te),a(U),a(Ce),a(E),a(Me),a(I),a(He),a(X),a(xe),a(ke),a(Je),a(S),a(Ze),a(Re),a(N),a(je),a(Fe),a(P),a(Le),a(Ue),a(Ee),a(V),a(Ie),a(Xe),a(q),a(Ye),a(O),a(Ge),a(Se),a(K),a(Ae),a(Ne),a(ne),a(De),a(Pe),a(te),a(We),a(ae),a(ze),a(Ve),a(oe)),a(d),u(b,e),u(H,e),u(k,e),u(Z,e),u(j,e),u(L,e),u(Y,e),u(G,e),u(A,e),u(D,e),u(W,e),u(z,e),u(B,e),u(Q,e),u(_,e),u(ee,e),u(se,e)}}}const jt='{"title":"Cache management","local":"cache-management","sections":[{"title":"Cache directory","local":"cache-directory","sections":[],"depth":2},{"title":"Download mode","local":"download-mode","sections":[],"depth":2},{"title":"Cache files","local":"cache-files","sections":[],"depth":2},{"title":"Enable or disable caching","local":"enable-or-disable-caching","sections":[],"depth":2},{"title":"Improve performance","local":"improve-performance","sections":[],"depth":2}],"depth":1}';function Ft(ce){return vt(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class Yt extends Ct{constructor(d){super(),Mt(this,d,Ft,Rt,yt,{})}}export{Yt as component};
